<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Talkomatic Room</title>
  <link rel="stylesheet" href="stylesheets/room.css">
  <link rel="icon" type="image/png" href="images/icons/favicon.png">
</head>
<body>
  <div class="page-container">
    <nav class="top-navbar">
      <div class="navbar-section navbar-left">
        <div id="dateTime" class="date-time">
          <span class="date"></span>
          <span class="time"></span>
        </div>
      </div>
      <div class="navbar-section navbar-center">
        <div class="brand">Talkomaticâ„¢</div>
      </div>
      <div class="navbar-section navbar-right">
        <!-- Normal users see Mute Toggle; leaders see Settings icon -->
        <button id="muteToggle" class="mute-toggle" aria-label="Toggle Sound">
          <img src="images/icons/sound-on.svg" alt="Sound On" id="muteIcon">
        </button>

        <button id="roomSettingsBtn" class="room-settings" style="display:none;">
          <img src="images/icons/settings.svg" alt="Settings" />
        </button>

        <div class="leave-room">Leave Room</div>
      </div>
    </nav>

    <div class="second-navbar">
      <div class="room-type">*</div>
      <div class="room-name">*</div>
      <div class="room-id">*</div>
    </div>

    <div class="chat-container"></div>

    <div class="invite-section">
      <div class="invite-text">Invite friends to your room with this link:</div>
      <div class="invite-container">
        <div class="invite-link" id="inviteLink"></div>
        <button id="copyInviteLink" aria-label="Copy invite link">
          <img src="images/icons/copy.svg" alt="Copy">
        </button>
      </div>
    </div>
  </div>

  <!-- ============================
       ROOM SETTINGS MODAL
       (Moderator Only)
  ============================= -->
  <div id="roomSettingsModal" class="moderator-modal">
    <div class="moderator-modal-content">
      <span id="roomSettingsModalClose" class="moderator-close">&times;</span>
      <h2 style="margin-top:0;margin-bottom:10px;font-size:20px;color:#FF9800;">Room Settings</h2>

      <!-- Lock/Unlock status text -->
      <p id="roomLockStatus" style="color:#FF9800; font-weight:bold;"></p>

      <div class="moderator-actions">
        <!-- Lock/Unlock button -->
        <button id="toggleLockBtn" class="mod-action-btn">Lock Room</button>
        <!-- Doorbell Mute for moderator only -->
        <button id="toggleDoorbellBtn" class="mod-action-btn">Mute Doorbell</button>
      </div>
    </div>
  </div>

  <!-- ============================
       USER SETTINGS MODAL
  ============================= -->
  <div id="userSettingsModal" class="moderator-modal">
    <div class="moderator-modal-content">
      <span id="userSettingsModalClose" class="moderator-close">&times;</span>
      <h2 id="moderatorModalTitle">User Settings</h2>

      <div class="moderator-target-info">
        <p>User: <span id="moderatorTargetName"></span></p>
        <p>Guest ID: <span id="moderatorTargetId"></span></p>
      </div>

      <div class="moderator-actions">
        <button id="modKickBtn" class="mod-action-btn">Kick (5 min)</button>
        <button id="modBanBtn" class="mod-action-btn">Ban (Permanent)</button>
        <button id="modMuteBtn" class="mod-action-btn">Mute (Global)</button>
        <button id="modTransferBtn" class="mod-action-btn">Grant Leadership</button>
      </div>
    </div>
  </div>

  <audio id="joinSound" src="audio/ding.mp3"></audio>
  <audio id="leaveSound" src="audio/ding.mp3"></audio>

  <!-- 1) Load socket.io -->
  <script src="/socket.io/socket.io.js"></script>

  <!-- 2) users.js (formerly fingerprint.js) -->
  <script src="js/users.js?v=1.0.4"></script>

  <!-- 3) init-socket-room.js to define socket for the room page -->
  <script src="js/init-socket-room.js?v=1.0.3"></script>

  <!-- 4) Then room-client that references socket -->
  <script src="js/room-client.js?v=1.1.1"></script>
</body>
</html>
